Our solution for handling loops is sloppy; fix it.
